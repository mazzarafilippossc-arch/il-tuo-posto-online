<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Il Tuo Posto Online</title>
<style>
body { font-family: 'Arial', sans-serif; margin:0; background:#f0f2f5; }
header { background:#ff6f61; color:white; padding:20px; text-align:center; }
header h1 { margin:0; }
header p { margin:5px 0 0 0; font-size:16px; }
.grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(220px,1fr)); gap:15px; padding:20px; }
.box { background:white; padding:10px; border-radius:10px; box-shadow:0 3px 8px rgba(0,0,0,0.1); display:flex; flex-direction:column; justify-content:space-between; }
.box img { max-width:100%; border-radius:6px; margin-bottom:5px; }
.box h4 { margin:5px 0; color:#333; }
.box p { font-size:14px; color:#555; }
.box a { text-decoration:none; color:#ff6f61; font-weight:bold; }
.pagination { text-align:center; margin:20px 0; }
.page-btn { margin:0 5px; cursor:pointer; padding:5px 10px; border-radius:5px; border:none; background:#ddd; }
.page-btn.active { background:#ff6f61; color:white; }
</style>

<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-storage-compat.js"></script>

<script>
// ðŸ”¹ FIREBASE CONFIG
const firebaseConfig = {
  apiKey: "AIzaSyCUROdEnMoABumEoYMheN-8x2w-CWfc1GQ",
  authDomain: "il-tuo-posto-online.firebaseapp.com",
  projectId: "il-tuo-posto-online",
  storageBucket: "il-tuo-posto-online.firebasestorage.app",
  messagingSenderId: "640085287509",
  appId: "1:640085287509:web:718a44398dd2050ad92adc",
  measurementId: "G-J56VHZ59KG"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const storage = firebase.storage();

let currentPage = 1;
const adsPerPage = 10;
let allAds = [];

// ðŸ”¹ Carica annunci approvati
async function loadAds(){
  const grid = document.getElementById('adGrid');
  grid.innerHTML="";

  const snapshot = await db.collection('ads').where('status','==','approved').orderBy('created','desc').get();
  allAds = snapshot.docs.map(doc => ({id:doc.id, ...doc.data()}));
  showPage(currentPage);
  renderPagination();
}

function showPage(page){
  const grid = document.getElementById('adGrid');
  grid.innerHTML="";

  const start = (page-1)*adsPerPage;
  const end = start + adsPerPage;
  const pageAds = allAds.slice(start,end);

  pageAds.forEach(ad=>{
    const div = document.createElement('div');
    div.className="box";
    div.innerHTML=`
      ${ad.image ? `<img src="${ad.image}">` : ''}
      <h4>${ad.title}</h4>
      <p>${ad.text}</p>
      ${ad.link ? `<a href="${ad.link}" target="_blank">Vai al link</a>` : ''}
    `;
    grid.appendChild(div);
  });
}

function renderPagination(){
  const pagDiv = document.getElementById('pagination');
  pagDiv.innerHTML="";
  const totalPages = Math.ceil(allAds.length/adsPerPage);
  for(let i=1;i<=totalPages;i++){
    const btn = document.createElement('button');
    btn.textContent=i;
    btn.className='page-btn'+(i===currentPage?' active':'');
    btn.onclick=()=>{currentPage=i; showPage(i); renderPagination();}
    pagDiv.appendChild(btn);
  }
}

window.onload = loadAds;
</script>
</head>
<body>
<header>
<h1>Il Tuo Posto Online</h1>
<p>Visualizza gli annunci gratuiti degli utenti</p>
</header>
<main>
<div class="grid" id="adGrid"></div>
<div class="pagination" id="pagination"></div>
</main>
</body>
</html>





